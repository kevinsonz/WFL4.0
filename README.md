# wfl
1. 概要
・ライフログ（時間単位の記録）、目標（予定）⇔評価（振返）を管理・記録するツールです。
　このツールを活用することにより、人生の計画と管理が行えるようになります。
※PCだけでなく、SmartPhone（以降SP）でも使用できることを前提に作り込んでいます。
※現在V4開発中です。
    現在V3運用中ですが、GitHubにはV4以降のモノを反映していく予定です。

2. 環境
＜本番環境＞
・Googleスプレッドシート（GSS）＋GAS（Google Apps Script）
・LL（ライフログ）シート＋MBO（目標（予定）⇔評価（振返））シート

＜動作確認＞
・PC：Mac
・SP：iPhone

3. 拡張子
・本来は〜.gsですが、VSCodeで色とかつくようにしたいので、敢えて〜.jsとしています。
　（GAS上では〜.gsとして格納した状態で使います。）

4. その他
＜履歴＞
・【V0】最初はGoogleスプレッドシートに書き込むだけの形から始めましたが、
    データ量が増えてきて管理し切れなくなってきました。
・【V1】条件付き書式＋数式の世界で作りましたが、
    SPだとプルダウンが引っ込む問題が発生し、見直しを要される状況となりました。
    また、データ量が多い問題に対し、入力とデータを分割する必要性が出てきました。
    →プルダウンが引っ込む問題はチェックボックスへ切り替えることで対処しました。
・【V2】データ量が増える一方となる問題については、以下の組合せで入力とデータを分割しました。
    →データはFormから入力し、Googleスプレッドシート（以降GSS）のFormシートへと入ってくる。
    →入力シートはarrayformula+vlookupで参照することが可能。
        その際、Formだとデータの修正ができないため、時刻を含むシリアルナンバーをデータに持たせ、
        新しいシリアルナンバーを参照する仕組みとすることで擬似的に修正できる形を実現した。
    →入力シートは性能重視とするため、閲覧は閲覧用シートを用意し、そちらで閲覧するようにした。
        ※LL（ライフログ）もMBO（目標（予定）⇔評価（振返））も同じ形式で実現。
    →iPhoneからはChrome（ブラウザ）を使うことで、誤操作によりシートを壊す可能性を予防しました。
・【V3】シリアルナンバーによるデータ管理が複雑すぎる問題があり、新方式を検討。
    →GAS（Google Apps Script）により、シートへ直接入力する方式に戻しつつ、
        完成したデータをバックアップ（過去ログ）ファイルへ移行できるようにしました。
        LLの入力シートを性能重視にする必要性は継続のため、入力と完了は分割し、
        入力→完了→過去ログという順番を経てデータを移行していく方式にしました。
    →MBOについてもGASでシート直接入力化しました。
        こちらは月単位でシートが分かれているのと、雛形が統一化されているため、
        当月→前月→過去ログという流れで運用する方式としました。
    →GASのマクロはFormメニュー送信→GSS：Formシート更新をトリガーに、
        Formシートの内容を基に判別して実行する方式としました。
        ※これにより、PC・SPどちらでもマクロ実行できるようにしました。
・【V4（開発中）】月の終盤ではSPアプリが落ちる事象が発生しました。
    条件付き書式の範囲が広くなりすぎていることが原因と考えております。
    また、V3が初プログラミングだったこともあり、コードが汚く、リファクタリングが必要な状況でした。
    これらを解消するため、条件付き書式禁止かつある程度変数等を整理した形で方式を見直し中です。
    →マクロ実行：Formを廃止し、編集・変更トリガーかつシート内に実行メニューを設ける形を目指します。
    →LL：条件付き書式をなくすことにより性能問題が解消されるはずなので、
        月単位で1シートとし、予め12ヶ月分のLLシートが用意されている状態にしようと思います。
    →MBO：LL同様条件付き書式は廃止し、こちらも性能問題が緩和されると思うので、
        上位（01年〜人生）は一まとめ、下位（01日〜01月）は年度単位にまとめようと思います。